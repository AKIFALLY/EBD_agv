# Rack 管理操作手冊

## 📋 文件資訊
- **版本**: 1.0
- **更新日期**: 2025-09-01
- **適用對象**: 現場操作人員、生產管理人員
- **系統版本**: RosAGV 2.0 (手動 Rack 管理模式)

## 🎯 使用場景
本手冊提供現場人員操作 OPUI 和 OPUI-HMI 系統管理 Rack 的詳細步驟，包括：
- 射出機區域的空 Rack 加入操作
- 人工收料區的 Rack 移出操作
- 異常情況處理流程
- 日常維護和監控

## 📱 OPUI 操作指南

### 1. 射出機區域 - 加入空 Rack

#### 準備工作
1. **確認空 Rack 可用性**
   - 檢查倉儲區是否有可用的空 Rack
   - 確認 Rack 編號標籤清晰可讀
   - 檢查 Rack 結構完整無損壞

2. **搬運空 Rack**
   - 使用手推車或人工搬運空 Rack 到射出機旁
   - 將 Rack 放置在指定的停車格位置
   - 確保 Rack 擺放平穩、方向正確

#### 操作步驟

##### Step 1: 開啟 OPUI 平板
```
位置：射出機操作台旁
登入：使用操作員工號和密碼
```

##### Step 2: 進入 Rack 管理功能
```
主介面 → 點選【Rack 管理】圖示
```
![OPUI 主介面示意]
- 🏭 生產管理
- 📦 **Rack 管理** ← 點選此項
- 📊 報表查詢
- ⚙️ 系統設定

##### Step 3: 選擇加入 Rack
```
Rack 管理介面 → 點選【加入 Rack】按鈕
```
操作選項：
- ➕ **加入 Rack** - 將新 Rack 納入系統
- ➖ 移出 Rack - (此功能在 OPUI-HMI)
- 🔍 查詢 Rack - 查看 Rack 狀態

##### Step 4: 輸入 Rack 資訊
```
1. 輸入 Rack 編號：
   範例：101, 102, 103...
   
2. 選擇停車格位置：
   下拉選單會顯示可用的停車格
   
3. 確認資訊：
   檢查輸入的編號和位置是否正確
```

##### Step 5: 提交並確認
```
點選【確認加入】按鈕
等待系統回應（約 2-3 秒）
```

##### Step 6: 檢查結果
✅ **成功訊息**：
```
「Rack 101 已成功加入系統」
「已分配至停車格 P-12」
```

❌ **失敗訊息及處理**：
| 錯誤訊息 | 可能原因 | 處理方法 |
|---------|---------|---------|
| Rack 已存在 | 該編號已在系統中 | 檢查編號是否正確 |
| 停車格已佔用 | 選擇的位置有其他 Rack | 選擇其他停車格 |
| 網路連線失敗 | 平板與系統斷線 | 檢查 WiFi 連線 |

### 2. 故障排除 - 加入 Rack

#### 常見問題 Q&A

**Q1: 掃描 Rack 編號時無法識別？**
```
A: 解決步驟
1. 清潔條碼標籤
2. 調整掃描角度和距離
3. 手動輸入編號
4. 若持續失敗，聯繫維護人員
```

**Q2: 系統顯示「無可用停車格」？**
```
A: 解決步驟
1. 檢查是否有 Rack 未正確移出系統
2. 查看停車格實際使用狀況
3. 等待其他 Rack 被移出
4. 聯繫調度人員協調
```

**Q3: 加入後 AGV 沒有來搬運？**
```
A: 檢查項目
1. 確認 Rack 已成功加入（查詢功能確認）
2. 檢查是否有其他高優先級任務
3. 確認 AGV 系統運行正常
4. 等待 3-5 分鐘後再觀察
```

## 🖥️ OPUI-HMI 操作指南

### 1. 人工收料區 - 移出 Rack

#### 準備工作
1. **完成收料作業**
   - 確認所有 carrier 已取出
   - 檢查 Rack 內無遺留物品
   - 記錄收料數量和狀態

2. **準備搬運**
   - 確認倉儲區存放位置
   - 準備搬運工具（如需要）

#### 操作步驟

##### Step 1: 開啟 OPUI-HMI 介面
```
位置：人工收料區工作站
登入：使用收料員工號和密碼
```

##### Step 2: 進入人工收料區管理
```
主介面 → 點選【人工收料區管理】
```
功能選項：
- 📥 收料登記
- 📤 **Rack 管理** ← 選擇此項
- 📊 收料統計

##### Step 3: 選擇要移出的 Rack
```
1. 查看當前收料區 Rack 列表
2. 找到已完成收料的 Rack
3. 點選該 Rack 的選擇框
```

Rack 列表顯示資訊：
| Rack ID | 位置 | 狀態 | Carrier 數 | 操作 |
|---------|------|------|-----------|------|
| 101 | M-51 | 已收料 | 0 | [移出] |
| 102 | M-52 | 收料中 | 3 | [--] |
| 103 | M-53 | 已收料 | 0 | [移出] |

##### Step 4: 執行移出操作
```
點選【移出系統】按鈕
```

##### Step 5: 確認移出
```
系統提示：
「確定要將 Rack 101 移出系統嗎？」
「移出後 location 將設為 null」

點選【確定】繼續
點選【取消】放棄操作
```

##### Step 6: 檢查結果
✅ **成功訊息**：
```
「Rack 101 已成功移出系統」
「請將 Rack 搬運至倉儲區」
```

##### Step 7: 實體搬運
1. 將空 Rack 從收料區搬出
2. 運送至指定倉儲區域
3. 按照倉儲規則擺放整齊
4. 更新倉儲區 Rack 數量記錄

### 2. 故障排除 - 移出 Rack

#### 常見問題 Q&A

**Q1: 顯示「Rack 仍有 Carrier」無法移出？**
```
A: 解決步驟
1. 重新檢查 Rack 內部
2. 在系統中查詢 Carrier 狀態
3. 手動清除系統中的 Carrier 記錄
4. 聯繫系統管理員處理資料異常
```

**Q2: 移出後發現還需要使用該 Rack？**
```
A: 恢復步驟
1. 立即停止實體搬運
2. 重新執行「加入 Rack」流程
3. 等待系統重新分配 location_id
4. 繼續原定作業
```

**Q3: 網路斷線導致操作中斷？**
```
A: 處理方法
1. 等待網路恢復
2. 重新登入 OPUI-HMI
3. 檢查 Rack 當前狀態
4. 若狀態不明，查詢資料庫確認
```

## 🚨 NG 處理流程

### OCR NG 檢測後的處理

#### 當 AGV 因 NG 停止時

##### Step 1: 接收通知
```
通知來源：
- 系統警報聲音
- OPUI 彈出訊息
- 手機 APP 推送（如有配置）
```

##### Step 2: 前往現場
```
1. 記下 AGV 編號和位置
2. 攜帶必要工具：
   - 手套
   - NG 標籤
   - 記錄表
3. 快速前往 AGV 停止位置
```

##### Step 3: 處理 NG 產品
```
1. 檢查 NG 原因：
   - OCR 識別錯誤
   - 產品缺陷
   - 擺放異常

2. 處理方式：
   - 取出 NG Carrier
   - 貼上 NG 標籤
   - 記錄 NG 資訊
```

##### Step 4: 恢復 AGV 運行
```
在 OPUI 上操作：
1. 選擇【AGV 管理】
2. 找到停止的 AGV
3. 點選【確認處理完成】
4. AGV 自動恢復運行
```

## 📊 日常監控和維護

### 1. 每日檢查項目

#### 早班開始（08:00）
- [ ] 檢查倉儲區空 Rack 數量
- [ ] 確認 OPUI 平板充電狀態
- [ ] 測試網路連線穩定性
- [ ] 查看前一天 NG 處理記錄

#### 班中檢查（每 2 小時）
- [ ] 監控系統中 Rack 分布
- [ ] 檢查 location=null 的 Rack 數量
- [ ] 確認無異常停滯的 Rack

#### 交班前（16:00/00:00）
- [ ] 統計當班 Rack 加入/移出數量
- [ ] 記錄異常事件和處理結果
- [ ] 清點倉儲區 Rack 實際數量
- [ ] 填寫交班記錄

### 2. 週期性維護

#### 每週維護
```
週一：
- 清潔所有 OPUI 平板螢幕
- 檢查 Rack 編號標籤完整性
- 測試所有功能按鈕

週三：
- 校驗系統 Rack 數量與實際數量
- 清理異常資料記錄

週五：
- 備份操作記錄
- 生成週報表
```

#### 每月維護
```
月初第一個工作日：
- 全面盤點 Rack 資產
- 檢查損壞 Rack 並標記維修
- 更新 Rack 編號對照表
- 優化倉儲區擺放佈局
```

## 📈 效能指標監控

### 關鍵指標
| 指標 | 目標值 | 監控頻率 | 負責人 |
|------|--------|----------|--------|
| Rack 加入響應時間 | < 5 秒 | 即時 | 操作員 |
| 每日 Rack 週轉率 | > 85% | 每日 | 班長 |
| location=null 比例 | < 20% | 每 4 小時 | 調度員 |
| NG 處理平均時間 | < 10 分鐘 | 每班 | 品管員 |

### 異常告警閾值
- **緊急**：location=null > 30%（系統外 Rack 過多）
- **警告**：Rack 加入失敗率 > 5%
- **注意**：單一停車格占用超過 2 小時

## 🔧 進階操作

### 批量操作（管理員權限）

#### 批量加入 Rack
```
適用場景：班次開始時需要加入多個 Rack

操作步驟：
1. OPUI → Rack 管理 → 批量操作
2. 選擇 Excel 檔案（格式：Rack_ID, Location）
3. 系統自動處理並顯示結果
4. 檢查失敗項目並手動處理
```

#### 批量移出 Rack
```
適用場景：班次結束清空收料區

操作步驟：
1. OPUI-HMI → 批量移出
2. 勾選所有已完成收料的 Rack
3. 確認批量移出
4. 系統自動更新 location=null
```

### 資料查詢和報表

#### 查詢 Rack 歷史
```
OPUI → 報表查詢 → Rack 軌跡

可查詢內容：
- Rack 移動路徑
- 狀態變更記錄
- 加入/移出時間
- 處理人員記錄
```

#### 生成統計報表
```
OPUI → 報表查詢 → 統計分析

報表類型：
- 日報：當日 Rack 使用統計
- 週報：週轉率趨勢分析
- 月報：Rack 資產盤點報告
```

## 📞 緊急聯絡

### 技術支援
- **系統故障**：IT 部門 分機 2345
- **網路問題**：網管中心 分機 2346
- **資料異常**：DBA 小組 分機 2347

### 現場支援
- **AGV 故障**：維護部門 分機 3456
- **Rack 損壞**：設備組 分機 3457
- **流程問題**：生產調度 分機 3458

### 緊急處理流程
```
發現問題 → 立即通報班長
         ↓
    嘗試標準處理流程
         ↓
    問題未解決？
         ↓
    聯繫技術支援
         ↓
    記錄問題和解決方案
```

## 📚 附錄

### A. 術語解釋
- **Rack**：料架，用於承載 Carrier 的框架
- **Carrier**：載具，裝載眼鏡產品的容器
- **location_id**：Rack 在系統中的位置識別碼
- **location=null**：Rack 不在系統管理中（在倉儲區）
- **停車格**：AGV 停靠和 Rack 放置的指定位置
- **OCR**：光學字符識別，用於檢測產品標識
- **NG**：Not Good，不良品

### B. 系統狀態代碼
| 代碼 | 含義 | 說明 |
|------|------|------|
| 200 | 成功 | 操作正常完成 |
| 400 | 參數錯誤 | 輸入資料有誤 |
| 404 | 找不到 | Rack 或位置不存在 |
| 409 | 衝突 | 資源已被占用 |
| 500 | 系統錯誤 | 內部錯誤，需技術支援 |

### C. 快速檢查清單

#### Rack 加入前檢查
- [ ] Rack 編號清晰可讀
- [ ] 結構完整無損壞
- [ ] 停車格位置可用
- [ ] OPUI 網路正常
- [ ] 系統狀態正常

#### Rack 移出前檢查
- [ ] 所有 Carrier 已取出
- [ ] 收料記錄已完成
- [ ] 倉儲區有存放空間
- [ ] OPUI-HMI 登入正常
- [ ] 確認無後續使用需求

### D. 更新記錄
| 版本 | 日期 | 更新內容 | 更新人 |
|------|------|----------|--------|
| 1.0 | 2025-09-01 | 初版發布，手動 Rack 管理模式 | System |
| | | | |

## 🔗 相關文檔
- 技術文檔：@docs-ai/knowledge/system/manual-rack-management.md
- 業務流程：@docs-ai/knowledge/business/eyewear-production-process.md
- WCS 設計：@docs-ai/knowledge/agv-domain/wcs-system-design.md
- TAFL 規格：@docs-ai/knowledge/system/tafl-language-specification.md