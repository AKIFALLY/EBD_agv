# âš ï¸ å·²æ£„ç”¨ä¸¦æ­¸æª” (DEPRECATED & ARCHIVED)

**æ£„ç”¨æ—¥æœŸ**: 2025-11-18
**æ­¸æª”åŸå› **: TAFL Editor å·²åœç”¨ï¼ŒTAFL ç³»çµ±å·²è¢« KUKA WCS å®Œå…¨å–ä»£
**æ›¿ä»£æ–¹æ¡ˆ**: ä½¿ç”¨ `kuka_wcs_ws` é€²è¡Œå€‰å„²æ§åˆ¶ç³»çµ±é–‹ç™¼
**é·ç§»æŒ‡å—**: åƒè¦‹ [TAFL åˆ° KUKA WCS é·ç§»æŒ‡å—](/home/ct/EBD_agv/docs-ai/guides/migration-from-tafl-to-kuka-wcs.md)

æœ¬æ–‡æª”å·²ç§»è‡³ archived ç›®éŒ„ï¼Œåƒ…ä¾›æ­·å²åƒè€ƒã€‚ä¸æ‡‰å†ç”¨æ–¼æ–°çš„é–‹ç™¼å·¥ä½œã€‚

---

# TAFL ç·¨è¼¯å™¨ä½¿ç”¨æŒ‡å—

## ğŸ¯ TAFL Editor ä»‹ç´¹

TAFL Editor æ˜¯ AGVCUI ç³»çµ±å…§å»ºçš„è¦–è¦ºåŒ–æµç¨‹ç·¨è¼¯å™¨ï¼Œæ¡ç”¨å¡ç‰‡å¼è¨­è¨ˆä¾†å‰µå»ºå’Œç®¡ç† TAFLï¼ˆTask Automation Flow Languageï¼‰æµç¨‹ã€‚æä¾›ç›´è¦ºçš„æ‹–æ”¾å¼æµç¨‹è¨­è¨ˆé«”é©—ã€‚

## ğŸ“‹ å­˜å–æ–¹å¼

### Web ä»‹é¢å…¥å£
- **URL**: `http://localhost:8001/tafl/editor`
- **ç³»çµ±ä½ç½®**: AGVCUI â†’ TAFL â†’ Editor
- **è·¯ç”±çµæ§‹**: `/tafl` (å‰ç¶´) + `/editor` (ç«¯é»)
- **æ³¨æ„**: ä¸æ˜¯ `/tafl-editor`ï¼Œè€Œæ˜¯ `/tafl/editor`

### ç³»çµ±è¦æ±‚
- **ç€è¦½å™¨**: Chrome/Firefox/Edge æœ€æ–°ç‰ˆæœ¬
- **è§£æåº¦**: å»ºè­° 1920x1080 ä»¥ä¸Š
- **æ¬Šé™**: éœ€è¦ AGVCUI ç³»çµ±ç™»å…¥æ¬Šé™

## ğŸ¨ ç·¨è¼¯å™¨ä»‹é¢çµæ§‹

### ä¸‰æ¬„å¼ä½ˆå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å·¦å´é¢æ¿    â”‚      ä¸­å¤®ç•«å¸ƒ        â”‚   å³å´é¢æ¿   â”‚
â”‚              â”‚                     â”‚              â”‚
â”‚ â€¢ Metadata   â”‚  â€¢ Cards è¦–åœ–        â”‚ â€¢ Properties â”‚
â”‚ â€¢ TAFL Verbs â”‚  â€¢ YAML è¦–åœ–         â”‚   (å¯éš±è—)  â”‚
â”‚              â”‚  â€¢ Both è¦–åœ–         â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é ‚éƒ¨å·¥å…·åˆ—
- **Flows ä¸‹æ‹‰é¸å–®**: è¼‰å…¥ç¾æœ‰æµç¨‹
- **New Flow**: å‰µå»ºæ–°æµç¨‹
- **Save**: å„²å­˜ç•¶å‰æµç¨‹
- **Validate**: é©—è­‰æµç¨‹èªæ³•
- **Test Run**: æ¨¡æ“¬åŸ·è¡Œæ¸¬è©¦
- **Execute**: åœ¨å¯¦éš›ç³»çµ±åŸ·è¡Œ

## ğŸ“ å·¦å´é¢æ¿è©³è§£

### Metadata Panelï¼ˆå…ƒè³‡æ–™é¢æ¿ï¼‰
- **Flow ID**: æµç¨‹æª”åï¼ˆä¾‹å¦‚ï¼š`example_001`ï¼‰
- **Flow Name**: æµç¨‹é¡¯ç¤ºåç¨±
- **Version**: ç‰ˆæœ¬è™Ÿï¼ˆé è¨­ 1.0ï¼‰
- **Description**: æµç¨‹æè¿°
- **Enabled**: æ˜¯å¦å•Ÿç”¨æ­¤æµç¨‹

### TAFL Verbs Panelï¼ˆå‹•è©å·¥å…·ç®±ï¼‰
åˆ†ç‚ºä¸‰å€‹åˆ†é ï¼š

#### Data Verbsï¼ˆè³‡æ–™å‹•è©ï¼‰
- **query**: æŸ¥è©¢è³‡æ–™åº«æˆ–ç³»çµ±è³‡æ–™
- **check**: æª¢æŸ¥æ¢ä»¶æˆ–ç‹€æ…‹
- **set**: è¨­å®šè®Šæ•¸å€¼

#### Control Verbsï¼ˆæ§åˆ¶å‹•è©ï¼‰
- **if**: æ¢ä»¶åˆ†æ”¯åŸ·è¡Œ
- **for**: è¿´åœˆéæ­·é›†åˆ
- **switch**: å¤šåˆ†æ”¯æ¢ä»¶

#### Action Verbsï¼ˆå‹•ä½œå‹•è©ï¼‰
- **create**: å‰µå»ºæ–°è³‡æºæˆ–è¨˜éŒ„
- **update**: æ›´æ–°ç¾æœ‰è³‡æ–™
- **stop**: åœæ­¢åŸ·è¡Œæˆ–ä»»å‹™
- **notify**: ç™¼é€é€šçŸ¥è¨Šæ¯

## ğŸ–¼ï¸ ä¸­å¤®ç•«å¸ƒåŠŸèƒ½

### é¡¯ç¤ºæ¨¡å¼åˆ‡æ›
ç·¨è¼¯å™¨æ”¯æ´ä¸‰ç¨®é¡¯ç¤ºæ¨¡å¼ï¼š

1. **Cards æ¨¡å¼**ï¼ˆé è¨­ï¼‰
   - ä»¥å¡ç‰‡å½¢å¼é¡¯ç¤ºæµç¨‹æ­¥é©Ÿ
   - æ”¯æ´æ‹–æ”¾é‡æ–°æ’åº
   - é»æ“Šå¡ç‰‡å±•é–‹ç·¨è¼¯

2. **YAML æ¨¡å¼**
   - é¡¯ç¤ºå®Œæ•´ YAML ç¨‹å¼ç¢¼
   - ä½¿ç”¨ CodeMirror ç·¨è¼¯å™¨
   - æ”¯æ´èªæ³•é«˜äº®å’Œè‡ªå‹•å®Œæˆ

3. **Both æ¨¡å¼**
   - åŒæ™‚é¡¯ç¤ºå¡ç‰‡å’Œ YAML
   - å³æ™‚é›™å‘åŒæ­¥
   - é©åˆå­¸ç¿’ TAFL èªæ³•

### å¡ç‰‡æ“ä½œ
- **æ·»åŠ å¡ç‰‡**: å¾å·¦å´å‹•è©é¢æ¿æ‹–æ”¾æˆ–é»æ“Š
- **ç·¨è¼¯å¡ç‰‡**: é»æ“Šå¡ç‰‡å±•é–‹å±¬æ€§ç·¨è¼¯å™¨
- **ç§»å‹•å¡ç‰‡**: æ‹–æ”¾é‡æ–°æ’åº
- **åˆªé™¤å¡ç‰‡**: é»æ“Šå¡ç‰‡å³ä¸Šè§’çš„åˆªé™¤æŒ‰éˆ•
- **è¤‡è£½å¡ç‰‡**: ä½¿ç”¨ Ctrl+C/Ctrl+V å¿«æ·éµ

## ğŸ”§ åŸºæœ¬æ“ä½œæµç¨‹

### å‰µå»ºæ–°æµç¨‹
1. é»æ“Š **New Flow** æŒ‰éˆ•
2. å¡«å¯« Metadata è³‡è¨Šï¼ˆIDã€åç¨±ã€æè¿°ï¼‰
3. å¾å·¦å´å‹•è©é¢æ¿é¸æ“‡éœ€è¦çš„å‹•è©
4. å°‡å‹•è©æ‹–æ”¾åˆ°ä¸­å¤®ç•«å¸ƒ
5. é»æ“Šå¡ç‰‡è¨­å®šåƒæ•¸
6. ä½¿ç”¨ **Validate** æª¢æŸ¥èªæ³•
7. é»æ“Š **Save** å„²å­˜æµç¨‹

### ç·¨è¼¯å¡ç‰‡åƒæ•¸ç¯„ä¾‹

#### Query å‹•è©
```yaml
- query:
    target: agvs           # æŸ¥è©¢ç›®æ¨™
    where:                 # æŸ¥è©¢æ¢ä»¶
      status: available
      battery: "> 30"
    order: battery DESC    # æ’åº
    limit: 5              # é™åˆ¶æ•¸é‡
    as: available_agvs    # å„²å­˜çµæœåˆ°è®Šæ•¸
```

#### If æ¢ä»¶å‹•è©
```yaml
- if:
    condition: "${available_agvs.length} > 0"
    then:
      - create:
          target: task
          with:
            agv_id: "${available_agvs[0].id}"
    else:
      - notify:
          level: warning
          message: "No AGV available"
```

#### For è¿´åœˆå‹•è©
```yaml
- for:
    in: "${available_agvs}"
    as: agv
    do:
      - update:
          target: agv_status
          where:
            id: "${agv.id}"
          set:
            assigned: true
```

## ğŸ® é€²éšåŠŸèƒ½

### è®Šæ•¸ç®¡ç†
- **å®šç¾©è®Šæ•¸**: ä½¿ç”¨ `set` å‹•è©æˆ–æŸ¥è©¢çµæœçš„ `as` åƒæ•¸
- **å¼•ç”¨è®Šæ•¸**: ä½¿ç”¨ `${variable_name}` æ ¼å¼
- **è®Šæ•¸ä½œç”¨åŸŸ**: å…¨æµç¨‹å…±äº«ï¼Œæ”¯æ´å·¢ç‹€çµæ§‹å…§çš„å±€éƒ¨è®Šæ•¸

### TAFL è¡¨é”å¼
- **ç°¡å–®è®Šæ•¸**: `$variable`
- **å±¬æ€§å­˜å–**: `$variable.property`
- **é™£åˆ—ç´¢å¼•**: `$array[0]`
- **è¤‡é›œè¡¨é”å¼**: `${variable.length > 0 && status == 'active'}`

### é©—è­‰åŠŸèƒ½
ç·¨è¼¯å™¨æä¾›ä¸‰å±¤é©—è­‰ï¼š
1. **èªæ³•é©—è­‰**: YAML æ ¼å¼æ­£ç¢ºæ€§
2. **çµæ§‹é©—è­‰**: TAFL å‹•è©å’Œåƒæ•¸å®Œæ•´æ€§
3. **é‚è¼¯é©—è­‰**: è®Šæ•¸å¼•ç”¨å’Œæµç¨‹é‚è¼¯åˆç†æ€§

## ğŸ“Š æ¨¡çµ„åŒ–æ¶æ§‹

TAFL Editor æ¡ç”¨ç¾ä»£åŒ–çš„æ¨¡çµ„åŒ–æ¶æ§‹ï¼ŒåŒ…å« 19 å€‹ ES6 æ¨¡çµ„ï¼š

### æ ¸å¿ƒæ¨¡çµ„
- `tafl-editor-core.js`: ä¸»å”èª¿å™¨
- `tafl-editor-state.js`: ç‹€æ…‹ç®¡ç†ï¼ˆObserver æ¨¡å¼ï¼‰
- `tafl-editor-api.js`: å¾Œç«¯ API é€šè¨Š
- `tafl-editor-config.js`: é…ç½®å’Œå¸¸æ•¸

### UI æ¨¡çµ„
- `tafl-editor-cards.js`: å¡ç‰‡å…ƒä»¶å’Œæ¸²æŸ“
- `tafl-editor-panels.js`: é¢æ¿ç®¡ç†ç³»çµ±
- `tafl-editor-modals.js`: å°è©±æ¡†ç³»çµ±

### äº’å‹•æ¨¡çµ„
- `tafl-editor-dragdrop.js`: æ‹–æ”¾åŠŸèƒ½
- `tafl-editor-events.js`: äº‹ä»¶è™•ç†å’Œå¿«æ·éµ
- `tafl-editor-canvas.js`: ç•«å¸ƒç®¡ç†

### å·¥å…·æ¨¡çµ„
- `tafl-editor-validator.js`: æµç¨‹é©—è­‰
- `tafl-editor-utils.js`: å·¥å…·å‡½æ•¸
- `tafl-editor-flow.js`: æµç¨‹ç®¡ç†

## ğŸ”— API æ•´åˆ

### å¾Œç«¯ç«¯é»
- `GET /tafl/flows`: å–å¾—æµç¨‹åˆ—è¡¨
- `GET /tafl/flows/{id}`: å–å¾—ç‰¹å®šæµç¨‹
- `POST /tafl/flows`: å„²å­˜æ–°æµç¨‹
- `PUT /tafl/flows/{id}`: æ›´æ–°æµç¨‹
- `DELETE /tafl/flows/{id}`: åˆªé™¤æµç¨‹
- `POST /tafl/validate`: é©—è­‰æµç¨‹
- `POST /tafl/execute`: åŸ·è¡Œæµç¨‹

### æµç¨‹å„²å­˜ä½ç½®
- **æª”æ¡ˆè·¯å¾‘**: `/app/config/tafl/flows/`
- **æª”æ¡ˆæ ¼å¼**: YAML (`.yaml` æˆ– `.tafl.yaml`)

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### å¿«æ·éµ
- `Ctrl+S`: å„²å­˜æµç¨‹
- `Ctrl+Z`: å¾©åŸ
- `Ctrl+Y`: é‡åš
- `Delete`: åˆªé™¤é¸ä¸­çš„å¡ç‰‡
- `Ctrl+D`: è¤‡è£½é¸ä¸­çš„å¡ç‰‡

### æœ€ä½³å¯¦è¸
1. **æœ‰æ„ç¾©çš„å‘½å**: Flow ID æ‡‰è©²æè¿°æµç¨‹ç”¨é€”
2. **é©ç•¶çš„è¨»è§£**: åœ¨ Description ä¸­èªªæ˜æµç¨‹ç›®çš„
3. **æ¨¡çµ„åŒ–è¨­è¨ˆ**: å°‡è¤‡é›œæµç¨‹æ‹†åˆ†ç‚ºå°æ¨¡çµ„
4. **è®Šæ•¸å‘½å**: ä½¿ç”¨æ¸…æ™°çš„è®Šæ•¸åç¨±
5. **éŒ¯èª¤è™•ç†**: ä½¿ç”¨ if/else è™•ç†ç•°å¸¸æƒ…æ³

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ
1. **ç„¡æ³•è¼‰å…¥æµç¨‹**: æª¢æŸ¥ `/app/config/tafl/flows/` ç›®éŒ„æ¬Šé™
2. **é©—è­‰å¤±æ•—**: æŸ¥çœ‹åº•éƒ¨ç‹€æ…‹åˆ—çš„è©³ç´°éŒ¯èª¤è¨Šæ¯
3. **å¡ç‰‡ç„¡æ³•æ‹–å‹•**: ç¢ºèªç€è¦½å™¨æ”¯æ´ HTML5 æ‹–æ”¾ API
4. **YAML èªæ³•éŒ¯èª¤**: æª¢æŸ¥ç¸®æ’ï¼ˆä½¿ç”¨ç©ºæ ¼è€Œé Tabï¼‰

### é™¤éŒ¯æ¨¡å¼
åœ¨ç€è¦½å™¨æ§åˆ¶å°åŸ·è¡Œï¼š
```javascript
window.taflEditor.enableDebug();  // å•Ÿç”¨é™¤éŒ¯æ¨¡å¼
window.taflEditor.getState();     // æŸ¥çœ‹ç•¶å‰ç‹€æ…‹
```

## ğŸ“š ç›¸é—œæ–‡æª”
- [TAFL èªè¨€è¦ç¯„](tafl-language.md)
- [TAFL ç³»çµ±æ¦‚è¦½](tafl-system.md)
- [TAFL WCS æ•´åˆ](tafl-wcs-integration.md)

---
*æœ€å¾Œæ›´æ–°: 2025-09-18*