# 滿料架到人工收料區 - 傳送箱出口滿車處理流程
name: "滿料架到人工收料區-傳送箱出口"
description: "當傳送箱出口有滿車時，需要搬運到人工收料區進行處理"
priority: 80
work_id: "220001"  # 使用 KUKA Rack 移動的 work_id
enabled: true

# 觸發條件 - 所有條件必須為 true 才執行
trigger_conditions:
  - condition: "transfer_exit_has_full_rack"
    description: "傳送箱出口位置有滿料架"
    parameters:
      location_type: "transfer_exit"
      
  - condition: "rack_is_full"
    description: "架上的 Carrier 已滿載"
    parameters:
      check_type: "full_capacity"
      
  - condition: "no_active_task_from_source"
    description: "來源地沒有進行中的運輸任務 (避免重複派車)"
    parameters:
      source_type: "transfer_exit"
      work_id: "220001"
      
  - condition: "manual_collection_area_available"
    description: "人工收料區有可用空間 (包含位置分配和衝突檢查)"
    parameters:
      area_type: "manual_collection"

# 執行動作
action:
  type: "create_task"
  task_type: "rack_transport"
  function: "rack_move"
  model: "KUKA400i"
  api: "submit_mission"
  mission_type: "RACK_MOVE"
  
  # 路徑配置
  path:
    type: "transfer_to_manual"
    source: "transfer_exit"
    destination: "manual_collection_area"

# 適用傳送箱出口位置 (基於資料庫 location 初始資料)  
# 20001: 房間2入口傳送箱 (測試用), 20002: 房間2出口傳送箱, 20003-20005: Simple WCS專用出口位置
applicable_locations: [20001, 20002, 20003, 20004, 20005]

# 調試選項
debug:
  enabled: false
  log_conditions: true
  dry_run: false