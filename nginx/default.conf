server {
    listen 80;
    server_name agvc.webapi;

    location / {
        proxy_pass http://192.168.100.100:8000;  # agvc.ui 導向 Node.js 8000
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

# 新增：localhost 專用配置，支援說明文件訪問
server {
    listen 80;
    server_name localhost;

    # 說明文件靜態服務 (優先處理)
    location /docs/ {
        root /usr/share/nginx/html;
        index index.html;
        try_files $uri $uri/ /docs/index.html;
        
        # 靜態資源快取最佳化
        location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
        
        # 安全標頭
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-XSS-Protection "1; mode=block" always;
    }

    # 預設重定向到 AGVCUI
    location / {
        proxy_pass http://192.168.100.100:8001;  # 重定向到 AGVCUI
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

server {
    listen 80;
    server_name agvc.ui;

    location / {
        proxy_pass http://192.168.100.100:8001;  # agvc.ui 導向 Node.js 8001
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # 新增：說明文件靜態服務 (優先處理)
    location /docs/ {
        root /usr/share/nginx/html;
        index index.html;
        try_files $uri $uri/ /docs/index.html;
        
        # 靜態資源快取最佳化
        location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
        
        # 安全標頭
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-XSS-Protection "1; mode=block" always;
    }
}

server {
    listen 80;
    server_name op.ui;
    location / {
        proxy_pass http://192.168.100.100:8002;  # op.ui 導向 Node.js 8002
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

}
