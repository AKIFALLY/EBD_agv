meta:
  updated_at: '2025-08-20T01:35:35.819590'
  version: 2.0.0
  source: Auto-synced from @flow_function decorators
  system: flow_wcs
  description: Flow WCS 函數庫定義 (自動更新)
  updated: '2025-08-20 18:25:43'
functions:
  query:
  - name: query.locations
    description: 查詢位置資料
    params:
    - type
    - rooms
    - has_rack
    returns: array
    defaults:
      type: enter_or_exit
      rooms:
      - 1
      - 2
      - 3
      - 4
      - 5
      has_rack: true
  - name: query.racks
    description: 查詢架台資料
    params:
    - location_id
    - status
    returns: array
    defaults:
      location_id: 1
      status: available
  - name: query.tasks
    description: 查詢任務資料
    params:
    - status
    - type
    - limit
    returns: array
    defaults:
      status: pending
      type: RACK_ROTATION
      limit: 10
  - name: query.agvs
    description: 查詢 AGV 資料
    params:
    - status
    - type
    returns: array
    defaults:
      status: idle
      type: cargo
  - name: query.rooms
    description: 查詢房間資訊
    params:
    - room_id
    - production_status
    returns: array
    defaults:
      room_id: null
      production_status: null
  check:
  - name: check.empty
    description: 檢查資料是否為空
    params:
    - data
    returns: boolean
    defaults:
      data: ${query_result}
  - name: check.rack_status
    description: 檢查架台狀態
    params:
    - rack_id
    - side
    - check_type
    returns: boolean
    defaults:
      rack_id: rack001
      side: a
      check_type: occupied
  - name: check.task_exists
    description: 檢查任務是否存在
    params:
    - type
    - location_id
    - rack_id
    - status
    returns: boolean
    defaults:
      type: RACK_ROTATION
      location_id: 1
      rack_id: null
      status: null
  - name: check.location_available
    description: 檢查位置是否可用
    params:
    - location_id
    returns: boolean
    defaults:
      location_id: 1
  - name: check.system_ready
    description: 檢查系統就緒狀態
    params:
    - components
    returns: boolean
    defaults:
      components:
      - database
      - agv_fleet
      - plc
  task:
  - name: task.create_task
    description: 建立新任務
    params:
    - type
    - work_id
    - location_id
    - rack_id
    - room_id
    - priority
    - metadata
    returns: string
    defaults:
      type: RACK_ROTATION
      work_id: 1
      location_id: loc001
      rack_id: null
      room_id: null
      priority: normal
      metadata: {}
  - name: task.update_task
    description: 更新任務狀態
    params:
    - task_id
    - status
    returns: boolean
    defaults:
      task_id: ${task_id}
      status: executing
  - name: task.assign_task
    description: 分配任務給 AGV
    params:
    - task_id
    - agv_id
    returns: object
    defaults:
      task_id: ${task_id}
      agv_id: agv01
  - name: task.cancel_task
    description: 取消任務
    params:
    - task_id
    - reason
    returns: boolean
    defaults:
      task_id: ${task_id}
      reason: User cancelled
  action:
  - name: action.rotate_rack
    description: 旋轉架台
    params:
    - rack_id
    - angle
    returns: boolean
    defaults:
      rack_id: rack001
      angle: 180
  - name: action.send_notification
    description: 發送通知
    params:
    - message
    - level
    - priority
    returns: boolean
    defaults:
      message: Task completed
      level: info
      priority: normal
  - name: action.log_message
    description: 記錄日誌
    params:
    - message
    - level
    - tags
    returns: boolean
    defaults:
      message: Flow step executed
      level: info
      tags: []
  - name: action.optimize_batch
    description: 最佳化任務批次
    params:
    - task_type
    - optimization_strategy
    returns: object
    defaults:
      task_type: RACK_ROTATION
      optimization_strategy: distance
  - name: action.analyze_priorities
    description: 分析任務優先級
    params:
    - tasks
    - strategy
    returns: array
    defaults:
      tasks: []
      strategy: deadline_first
  - name: action.find_optimal_agv
    description: 尋找最佳 AGV
    params:
    - task
    - agvs
    - criteria
    returns: object
    defaults:
      task: {}
      agvs: []
      criteria:
      - distance
  - name: action.recover_from_error
    description: 錯誤恢復
    params:
    - error_type
    - step_id
    - retry_count
    returns: object
    defaults:
      error_type: unknown
      step_id: ''
      retry_count: 3
  - name: action.calculate_metrics
    description: 計算效能指標
    params:
    - metrics
    returns: object
    defaults:
      metrics:
      - task_completion_rate
  - name: action.optimize_performance
    description: 優化系統效能
    params:
    - target
    - threshold
    returns: object
    defaults:
      target: efficiency
      threshold: 80
  - name: action.send_alert
    description: 發送警報
    params:
    - message
    - severity
    returns: boolean
    defaults:
      message: System alert
      severity: warning
  - name: action.cleanup_resources
    description: 清理資源
    params:
    - targets
    returns: boolean
    defaults:
      targets:
      - temp_variables
  - name: action.generate_report
    description: 生成報告
    params:
    - flow_id
    - include
    returns: object
    defaults:
      flow_id: ''
      include:
      - execution_time
      - tasks_processed
  - name: action.save_data
    description: 保存資料到檔案
    params:
    - data
    - path
    returns: boolean
    defaults:
      data: {}
      path: /tmp/flow_data.json
  - name: action.send_alarm
    description: 發送警報
    params:
    - message
    - severity
    returns: boolean
    defaults:
      message: System alert
      severity: medium
  - name: action.trigger_event
    description: 觸發事件
    params:
    - event_type
    - agv_id
    - data
    returns: boolean
    defaults:
      event_type: custom_event
      agv_id: null
      data: {}
  control:
  - name: control.wait_time
    description: 等待指定時間
    params:
    - seconds
    returns: boolean
    defaults:
      seconds: 1.0
  - name: control.stop_flow
    description: 停止流程執行
    params:
    - reason
    returns: boolean
    defaults:
      reason: Condition met
  - name: control.count_items
    description: 計算項目數量
    params:
    - variable
    returns: number
    defaults:
      variable: ${query_result}
  - name: control.switch_case
    description: Switch case 控制
    params:
    - value
    - cases
    - default
    returns: any
    defaults:
      value: ${status}
      cases:
        pending: wait
        ready: execute
      default: skip
  - name: control.foreach
    description: 迴圈遍歷
    params:
    - items
    - var
    - steps
    - max_iterations
    returns: array
    defaults:
      items: []
      var: item
      steps: []
      max_iterations: 1000
  - name: control.update_variable
    description: 更新變數值
    params:
    - variable
    - operation
    - value
    returns: any
    defaults:
      variable: counter
      operation: set
      value: 0
  - name: control.switch
    description: 條件分支控制
    params:
    - value
    - cases
    returns: any
    defaults:
      value: 0
      cases: []
  special:
  - name: foreach
    description: 迴圈遍歷
    params:
    - items
    - var
    - steps
    - max_iterations
    returns: array
    defaults:
      items: []
      var: item
      steps: []
      max_iterations: 1000
