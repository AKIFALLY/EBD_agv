# CT 任務分配配置文件
# 用于 simple_ct_manager.py 根據 work_id 分配任務到指定的 AGV
# 版本: 1.0
# 最後更新: 2025-10-21

version: "1.0"
enabled: true

# ============================================================================
# AGV 能力定義
# 定義每台 AGV 的能力、限制和配置
# ============================================================================
agv_capabilities:
  cargo02:
    model: "Cargo"                   # AGV 型號
    rooms: [1, 2]                    # 可運行的房間列表 (空列表 = 所有房間)
    max_concurrent_tasks: 1          # 最大並發任務數
    enabled: true                    # 是否啟用此 AGV
    description: "Cargo AGV 負责入口/出口傳送箱搬運"

  loader02:
    model: "Loader"
    rooms: [1, 2]
    max_concurrent_tasks: 1
    enabled: true
    description: "Loader AGV 負责清洗機、泡藥機等设備上下料"

  unloader02:
    model: "Unloader"
    rooms: [1, 2]
    max_concurrent_tasks: 1
    enabled: true
    description: "Unloader AGV 負责预烘機、烘箱取料和出口傳送箱"

# ============================================================================
# work_id → AGV 直接映射
# 每個 work_id 指定分配给哪台 AGV
# ============================================================================
work_id_allocations:
  # -------------------------------------------------------------------------
  # Cargo AGV 任務 (2000xxx)
  # -------------------------------------------------------------------------
  2000102:                           # CargoAGV放入口傳送箱
    agv_name: "cargo02"
    priority_override: null          # null = 使用任務原始優先級
    room_override: null              # null = 使用任務指定的房間
    description: "Cargo AGV 放料到入口傳送箱"

  2000201:                           # CargoAGV拿出口傳送箱
    agv_name: "cargo02"
    priority_override: null
    room_override: null
    description: "Cargo AGV 從出口傳送箱取料"

  # -------------------------------------------------------------------------
  # Loader AGV 任務 (2010xxx, 2030xxx, 2040xxx)
  # -------------------------------------------------------------------------
  2010101:                           # LoaderAGV取入口傳送箱
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從入口傳送箱取料"

  2010301:                           # LoaderAGV取入口傳送箱
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從入口傳送箱取料"

  2030101:                           # LoaderAGV取清洗機上層
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從清洗機上層取料"

  2030102:                           # LoaderAGV放清洗機
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到清洗機"

  2030201:                           # LoaderAGV取清洗機
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從清洗機取料"

  2030302:                           # LoaderAGV放清洗機下層
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到清洗機下層 Station 03"

  2040101:                           # LoaderAGV拿泡藥機A
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從泡藥機A取料"

  2040102:                           # LoaderAGV放泡藥機A
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到泡藥機A"

  2040201:                           # LoaderAGV拿泡藥機B
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040202:                           # LoaderAGV放泡藥機B
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040301:                           # LoaderAGV拿泡藥機C
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040302:                           # LoaderAGV放泡藥機C
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040401:                           # LoaderAGV拿泡藥機D
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040402:                           # LoaderAGV放泡藥機D
    agv_name: "loader02"
    priority_override: null
    room_override: null

  2040501:                           # LoaderAGV拿泡藥機E
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從泡藥機E取料"

  2040502:                           # LoaderAGV放泡藥機E
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到泡藥機E"

  2040601:                           # LoaderAGV拿泡藥機F
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 從泡藥機F取料"

  2040602:                           # LoaderAGV放泡藥機F
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到泡藥機F"

  2050101:                           # LoaderAGV放预烘機B1256門
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 B1256門"

  2050102:                           # LoaderAGV放预烘機 Station 01
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 Station 01"

  2050301:                           # LoaderAGV放预烘機B3478門
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 B3478門"

  2050302:                           # LoaderAGV放预烘機 Station 03
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 Station 03"

  2050502:                           # LoaderAGV放预烘機 Station 05
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 Station 05"

  2050702:                           # LoaderAGV放预烘機 Station 07
    agv_name: "loader02"
    priority_override: null
    room_override: null
    description: "Loader AGV 放料到预烘機 Station 07"

  # -------------------------------------------------------------------------
  # Unloader AGV 任務 (2020xxx, 2051xxx, 2060xxx)
  # -------------------------------------------------------------------------
  2020102:                           # UnloaderAGV放出口傳送箱
    agv_name: "unloader02"
    priority_override: null
    room_override: null
    description: "Unloader AGV 放料到出口傳送箱"

  2051101:                           # UnloaderAGV取预烘B1256門
    agv_name: "unloader02"
    priority_override: 3             # 预烘機任務優先級较高
    room_override: null
    description: "Unloader AGV 從预烘機 B1256門 取料"

  2051301:                           # UnloaderAGV取预烘B3478門
    agv_name: "unloader02"
    priority_override: 3
    room_override: null
    description: "Unloader AGV 從预烘機 B3478門 取料"

  2060101:                           # UnloaderAGV取烘箱上排
    agv_name: "unloader02"
    priority_override: null
    room_override: null
    description: "Unloader AGV 從烘箱上排取料"

  2060502:                           # UnloaderAGV放烘箱下排
    agv_name: "unloader02"
    priority_override: null
    room_override: null
    description: "Unloader AGV 放料到烘箱下排"

# ============================================================================
# 默認分配策略
# 当 work_id 不在映射表中時的處理方式
# ============================================================================
default_allocation:
  enabled: false                     # 是否啟用默認分配 (false = 不分配未配置的任務)
  fallback_agv: null                 # 默認分配的 AGV (null = 不分配)
  log_unmapped: true                 # 是否記錄未映射的 work_id

# ============================================================================
# 熱重載配置
# 配置文件变更檢測和自動重載
# ============================================================================
reload_config:
  enabled: true                      # 是否啟用熱重載
  check_interval: 10.0               # 檢查間隔（秒）
  log_on_reload: true                # 重載時是否記錄日志

# ============================================================================
# 调试選項
# ============================================================================
debug:
  verbose_logging: false             # 是否啟用详细日志
  log_allocation_decisions: true     # 是否記錄每次分配決策
  log_skipped_tasks: true            # 是否記錄跳過的任務
