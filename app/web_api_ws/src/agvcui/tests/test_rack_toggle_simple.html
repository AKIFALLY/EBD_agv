<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²¨æ¶åˆ‡æ›æŒ‰éˆ•ç°¡å–®æ¸¬è©¦</title>
    <link rel="stylesheet" href="/static/css/bulma_1_0_4.min.css" />
    <link rel="stylesheet" href="/static/css/materialdesignicons.min.css" />
    <link rel="stylesheet" href="/static/css/agvcui-bulma-extend.css" />
    <link rel="stylesheet" href="/static/css/mapPage.css" />
    <style>
        .test-container {
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #dbdbdb;
            border-radius: 6px;
        }
        .demo-area {
            position: relative;
            height: 200px;
            background: #e8e8e8;
            border: 1px solid #ccc;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .log-output {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.875rem;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="title">è²¨æ¶åˆ‡æ›æŒ‰éˆ•ç°¡å–®æ¸¬è©¦</h1>
        
        <div class="test-section">
            <h2 class="subtitle">æ¸¬è©¦æ§åˆ¶</h2>
            <div class="buttons">
                <button class="button is-primary" onclick="testToggle()">ğŸ”„ æ¸¬è©¦åˆ‡æ›</button>
                <button class="button is-info" onclick="inspectButton()">ğŸ” æª¢æŸ¥æŒ‰éˆ•</button>
                <button class="button is-light" onclick="clearLog()">ğŸ—‘ï¸ æ¸…é™¤æ—¥èªŒ</button>
            </div>
        </div>

        <div class="test-section">
            <h2 class="subtitle">è²¨æ¶æ¼”ç¤º</h2>
            <div class="demo-area">
                <div class="rack" id="test-rack">
                    <!-- æœ€å°åŒ–é¡¯ç¤º -->
                    <div id="rack-info-test-min" class="rack-moving hidden">
                        <!-- åˆ‡æ›æŒ‰éˆ• - æœ€å°åŒ–æ¨¡å¼ -->
                        <div class="rack-toggle-btn" id="rack-toggle-test-min" title="åˆ‡æ›é¡¯ç¤ºæ¨¡å¼">
                            â‡„
                        </div>
                        <span class="rack-name">æ¸¬è©¦è²¨æ¶</span>
                    </div>

                    <!-- è©³ç´°é¡¯ç¤º -->
                    <div id="rack-info-test-max" class="rack-static">
                        <!-- åˆ‡æ›æŒ‰éˆ• - è©³ç´°æ¨¡å¼ -->
                        <div class="rack-toggle-btn" id="rack-toggle-test-max" title="åˆ‡æ›é¡¯ç¤ºæ¨¡å¼">
                            â‡„
                        </div>
                        
                        <div class="rack-label has-radius-top-left has-radius-top-right span3">
                            <span class="product-name">æ¸¬è©¦ç”¢å“</span>
                        </div>
                        <div class="rack-label has-radius-bottom-left">
                            <span class="size">å¤§</span>
                        </div>
                        <div class="rack-label has-radius-bottom-right span2">
                            <span class="count">5</span>
                            <span class="slash">/</span>
                            <span class="total">10</span>
                        </div>
                        <div class="rack-title has-radius-top-left has-radius-top-right span3">
                            <span class="rack-name">æ¸¬è©¦è²¨æ¶</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="subtitle">æ¸¬è©¦æ—¥èªŒ</h2>
            <div class="log-output" id="log-output"></div>
        </div>
    </div>

    <script>
        let logOutput = document.getElementById('log-output');
        let isMiniMode = false;

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logOutput.textContent += `[${timestamp}] ${message}\n`;
            logOutput.scrollTop = logOutput.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            logOutput.textContent = '';
        }

        function setMini(mini) {
            const minElement = document.getElementById('rack-info-test-min');
            const maxElement = document.getElementById('rack-info-test-max');
            
            if (mini) {
                minElement.classList.remove('hidden');
                maxElement.classList.add('hidden');
                log('åˆ‡æ›åˆ°æœ€å°åŒ–æ¨¡å¼');
            } else {
                minElement.classList.add('hidden');
                maxElement.classList.remove('hidden');
                log('åˆ‡æ›åˆ°è©³ç´°æ¨¡å¼');
            }
            
            isMiniMode = mini;
        }

        function testToggle() {
            log('åŸ·è¡Œåˆ‡æ›æ¸¬è©¦...');
            setMini(!isMiniMode);
        }

        function inspectButton() {
            log('æª¢æŸ¥åˆ‡æ›æŒ‰éˆ•...');
            
            const buttons = document.querySelectorAll('.rack-toggle-btn');
            log(`æ‰¾åˆ° ${buttons.length} å€‹åˆ‡æ›æŒ‰éˆ•`);
            
            buttons.forEach((btn, index) => {
                const styles = getComputedStyle(btn);
                const rect = btn.getBoundingClientRect();
                
                log(`æŒ‰éˆ• ${index + 1}:`);
                log(`  ID: ${btn.id}`);
                log(`  display: ${styles.display}`);
                log(`  visibility: ${styles.visibility}`);
                log(`  opacity: ${styles.opacity}`);
                log(`  position: ${styles.position}`);
                log(`  top: ${styles.top}`);
                log(`  right: ${styles.right}`);
                log(`  z-index: ${styles.zIndex}`);
                log(`  background: ${styles.backgroundColor}`);
                log(`  width: ${styles.width}`);
                log(`  height: ${styles.height}`);
                log(`  é‚Šç•Œæ¡†: ${rect.width}x${rect.height} at (${rect.left}, ${rect.top})`);
                log(`  æ˜¯å¦å¯è¦‹: ${rect.width > 0 && rect.height > 0}`);
                
                // æª¢æŸ¥çˆ¶å®¹å™¨
                const parent = btn.parentElement;
                if (parent) {
                    const parentStyles = getComputedStyle(parent);
                    log(`  çˆ¶å®¹å™¨ display: ${parentStyles.display}`);
                    log(`  çˆ¶å®¹å™¨ overflow: ${parentStyles.overflow}`);
                    log(`  çˆ¶å®¹å™¨ position: ${parentStyles.position}`);
                }
            });
        }

        // è¨­ç½®æŒ‰éˆ•é»æ“Šäº‹ä»¶
        function setupButtonEvents() {
            const buttons = document.querySelectorAll('.rack-toggle-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    e.preventDefault();
                    log(`æŒ‰éˆ• ${btn.id} è¢«é»æ“Š`);
                    testToggle();
                });
            });
            log(`å·²è¨­ç½® ${buttons.length} å€‹æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('âœ… é é¢è¼‰å…¥å®Œæˆ');
            setupButtonEvents();
            setMini(true); // åˆå§‹è¨­ç‚ºæœ€å°åŒ–æ¨¡å¼
            log('ğŸ’¡ æç¤ºï¼šæŸ¥çœ‹å³ä¸Šè§’æ˜¯å¦æœ‰ â‡„ ç¬¦è™Ÿçš„åˆ‡æ›æŒ‰éˆ•');
            
            // è‡ªå‹•æª¢æŸ¥æŒ‰éˆ•
            setTimeout(() => {
                inspectButton();
            }, 100);
        });
    </script>
</body>
</html>
